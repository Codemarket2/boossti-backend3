{"version":3,"file":"getTags.js","sourceRoot":"","sources":["getTags.ts"],"names":[],"mappings":";;;AAAA,8DAAkD;AAClD,sEAA0D;AAEnD,MAAM,OAAO,GAAG,KAAK,EAAE,IAAI,EAAE,EAAE;IACpC,IAAI,QAAQ,GAAG,IAAI,CAAC;IACpB,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IAClC,IAAI,IAAI,GAAQ,EAAE,CAAC;IACnB,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,EAAE;QACrB,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE;YACvB,MAAM,GAAG,GAAG,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC;YACnC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SAChB;IACH,CAAC,CAAC,CAAC;IACH,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;QACnB,IAAI,QAAQ,GAAQ,EAAE,CAAC;QACvB,QAAQ,GAAG,MAAM,uBAAQ,CAAC,IAAI,CAAC;YAC7B,GAAG,EAAE;gBACH,GAAG,EAAE,IAAI;aACV;SACF,CAAC,CAAC;QACH,QAAQ,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC,CAAC,CAAC;QACvE,IAAI,QAAQ,GAAQ,EAAE,CAAC;QACvB,QAAQ,GAAG,MAAM,mBAAI,CAAC,IAAI,CAAC;YACzB,GAAG,EAAE;gBACH,GAAG,EAAE,IAAI;aACV;SACF,CAAC,CAAC;QACH,QAAQ,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC;QACnE,IAAI,GAAG,CAAC,GAAG,QAAQ,EAAE,GAAG,QAAQ,CAAC,CAAC;KACnC;IACD,6BAA6B;IAC7B,OAAO,IAAI,CAAC;AACd,CAAC,CAAC;AA7BW,QAAA,OAAO,WA6BlB","sourcesContent":["import Page from '../../template/utils/pageModel';\r\nimport Template from '../../template/utils/templateModel';\r\n\r\nexport const getTags = async (body) => {\r\n  let postBody = body;\r\n  postBody = postBody.split('^^__');\r\n  let tags: any = [];\r\n  postBody.forEach((m) => {\r\n    if (m.includes('@@@__')) {\r\n      const tag = m.split('@@@__').pop();\r\n      tags.push(tag);\r\n    }\r\n  });\r\n  if (tags.length > 0) {\r\n    let typeTags: any = [];\r\n    typeTags = await Template.find({\r\n      _id: {\r\n        $in: tags,\r\n      },\r\n    });\r\n    typeTags = typeTags.map((l) => ({ tag: l._id, tagModel: 'Template' }));\r\n    let itemTags: any = [];\r\n    itemTags = await Page.find({\r\n      _id: {\r\n        $in: tags,\r\n      },\r\n    });\r\n    itemTags = itemTags.map((l) => ({ tag: l._id, tagModel: 'Page' }));\r\n    tags = [...typeTags, ...itemTags];\r\n  }\r\n  // console.log('tags', tags);\r\n  return tags;\r\n};\r\n"]}